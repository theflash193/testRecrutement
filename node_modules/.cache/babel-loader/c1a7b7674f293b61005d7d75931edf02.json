{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nrequire(\"./index.css\");\n\nvar _spinner = _interopRequireDefault(require(\"../spinner\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n          if (desc.get || desc.set) {\n            Object.defineProperty(newObj, key, desc);\n          } else {\n            newObj[key] = obj[key];\n          }\n        }\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nvar BackgroundImage = function BackgroundImage(props) {\n  var src = props.src,\n      color = props.color,\n      opacity = props.opacity,\n      transition = props.transition,\n      width = props.width,\n      height = props.height,\n      radius = props.radius,\n      position = props.position,\n      size = props.size,\n      onClick = props.onClick;\n\n  var _useState = (0, _react.useState)(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var ghost = (0, _react.useRef)();\n  var image = (0, _react.useRef)();\n\n  var _useState5 = (0, _react.useState)({\n    position: position,\n    width: width,\n    height: height,\n    backgroundColor: color,\n    borderRadius: radius\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      bgContainerStyle = _useState6[0],\n      setBgContainerStyle = _useState6[1];\n\n  var _useState7 = (0, _react.useState)({\n    // background: `url(${src}) no-repeat center center fixed`,\n    background: \"url(\".concat(src, \") no-repeat center center\"),\n    backgroundSize: size,\n    // cover|auto|contain\n    width: width,\n    height: height,\n    borderRadius: radius,\n    transition: \"opacity \".concat(transition)\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      bgStyle = _useState8[0],\n      setBgStyle = _useState8[1];\n\n  var getCalculatedDimension = function getCalculatedDimension(width, height) {\n    // FIXME\n    // à repenser complètement\n    if (width !== \"100%\" && (!height || height === \"auto\")) {\n      var intWidth = parseInt(width.replace(\"px\", \"\"), 10);\n      var heightWRatio = parseInt(ghost.current.height / (ghost.current.width / intWidth), 10);\n      return {\n        width: \"\".concat(intWidth, \"px\"),\n        height: \"\".concat(heightWRatio, \"px\")\n      };\n    } else {\n      return {\n        width: width,\n        height: height // return { width: ghost.current.width, height: ghost.current.height }\n\n      };\n    }\n  };\n\n  (0, _react.useEffect)(function () {\n    setError(false);\n    setLoading(true);\n\n    if (src) {\n      ghost.current = new Image();\n      ghost.current.src = src;\n\n      ghost.current.onload = function () {\n        setBgContainerStyle(function (prev) {\n          return _objectSpread({}, prev, {}, getCalculatedDimension(width, height));\n        });\n        setBgStyle(function (prev) {\n          return _objectSpread({}, prev, {}, getCalculatedDimension(width, height), {\n            background: \"url(\".concat(src, \") no-repeat center center\")\n          });\n        });\n        setLoading(false);\n      };\n\n      ghost.current.onerror = function () {\n        setLoading(false);\n        setBgStyle(function (prev) {\n          return _objectSpread({}, prev, {\n            background: \"\"\n          });\n        });\n        setError(\"Image not found\");\n      };\n    }\n  }, [src, width, height]);\n  (0, _react.useEffect)(function () {\n    image.current.style.opacity = 0;\n\n    if (!loading) {\n      // opacity et backgroundSize ne passent que par le biais de la ref, \n      // seulement une fois que l'image est réellement loadée\n      image.current.style.opacity = opacity;\n      image.current.style.backgroundSize = size;\n    }\n  }, [loading, size, opacity]);\n  return _react.default.createElement(\"div\", {\n    className: \"bgContainer\",\n    style: bgContainerStyle,\n    onClick: onClick\n  }, _react.default.createElement(\"div\", {\n    ref: image,\n    className: \"bg\",\n    style: bgStyle\n  }), loading && _react.default.createElement(_spinner.default, null), _react.default.createElement(\"div\", {\n    style: {\n      position: \"relative\"\n    }\n  }, !loading && !error && props.children, error));\n};\n\nBackgroundImage.propTypes = {\n  src: _propTypes.default.string.isRequired,\n  position: _propTypes.default.string,\n  width: _propTypes.default.string,\n  height: _propTypes.default.string,\n  opacity: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),\n  color: _propTypes.default.string,\n  transition: _propTypes.default.string,\n  radius: _propTypes.default.string,\n  size: _propTypes.default.string,\n  onClick: _propTypes.default.func\n};\nBackgroundImage.defaultProps = {\n  src: \"\",\n  position: \"relative\",\n  width: \"300px\",\n  height: \"300px\",\n  opacity: \"1\",\n  color: \"#ccc\",\n  transition: \"1s\",\n  radius: \"0\",\n  size: \"cover\",\n  onClick: function onClick() {}\n};\nvar _default = BackgroundImage;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/gordon/node_modules/@bit/dweez.react.background-image/dist/background-image/index.js"],"names":["Object","defineProperty","exports","value","default","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_spinner","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","desc","getOwnPropertyDescriptor","get","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","err","Array","isArray","BackgroundImage","props","src","color","opacity","transition","width","height","radius","position","size","onClick","_useState","useState","_useState2","loading","setLoading","_useState3","_useState4","error","setError","ghost","useRef","image","_useState5","backgroundColor","borderRadius","_useState6","bgContainerStyle","setBgContainerStyle","_useState7","background","concat","backgroundSize","_useState8","bgStyle","setBgStyle","getCalculatedDimension","intWidth","parseInt","replace","heightWRatio","current","useEffect","Image","onload","prev","onerror","style","createElement","className","ref","children","propTypes","string","isRequired","oneOfType","number","func","defaultProps","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nrequire(\"./index.css\");\n\nvar _spinner = _interopRequireDefault(require(\"../spinner\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar BackgroundImage = function BackgroundImage(props) {\n  var src = props.src,\n      color = props.color,\n      opacity = props.opacity,\n      transition = props.transition,\n      width = props.width,\n      height = props.height,\n      radius = props.radius,\n      position = props.position,\n      size = props.size,\n      onClick = props.onClick;\n\n  var _useState = (0, _react.useState)(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var ghost = (0, _react.useRef)();\n  var image = (0, _react.useRef)();\n\n  var _useState5 = (0, _react.useState)({\n    position: position,\n    width: width,\n    height: height,\n    backgroundColor: color,\n    borderRadius: radius\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      bgContainerStyle = _useState6[0],\n      setBgContainerStyle = _useState6[1];\n\n  var _useState7 = (0, _react.useState)({\n    // background: `url(${src}) no-repeat center center fixed`,\n    background: \"url(\".concat(src, \") no-repeat center center\"),\n    backgroundSize: size,\n    // cover|auto|contain\n    width: width,\n    height: height,\n    borderRadius: radius,\n    transition: \"opacity \".concat(transition)\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      bgStyle = _useState8[0],\n      setBgStyle = _useState8[1];\n\n  var getCalculatedDimension = function getCalculatedDimension(width, height) {\n    // FIXME\n    // à repenser complètement\n    if (width !== \"100%\" && (!height || height === \"auto\")) {\n      var intWidth = parseInt(width.replace(\"px\", \"\"), 10);\n      var heightWRatio = parseInt(ghost.current.height / (ghost.current.width / intWidth), 10);\n      return {\n        width: \"\".concat(intWidth, \"px\"),\n        height: \"\".concat(heightWRatio, \"px\")\n      };\n    } else {\n      return {\n        width: width,\n        height: height // return { width: ghost.current.width, height: ghost.current.height }\n\n      };\n    }\n  };\n\n  (0, _react.useEffect)(function () {\n    setError(false);\n    setLoading(true);\n\n    if (src) {\n      ghost.current = new Image();\n      ghost.current.src = src;\n\n      ghost.current.onload = function () {\n        setBgContainerStyle(function (prev) {\n          return _objectSpread({}, prev, {}, getCalculatedDimension(width, height));\n        });\n        setBgStyle(function (prev) {\n          return _objectSpread({}, prev, {}, getCalculatedDimension(width, height), {\n            background: \"url(\".concat(src, \") no-repeat center center\")\n          });\n        });\n        setLoading(false);\n      };\n\n      ghost.current.onerror = function () {\n        setLoading(false);\n        setBgStyle(function (prev) {\n          return _objectSpread({}, prev, {\n            background: \"\"\n          });\n        });\n        setError(\"Image not found\");\n      };\n    }\n  }, [src, width, height]);\n  (0, _react.useEffect)(function () {\n    image.current.style.opacity = 0;\n\n    if (!loading) {\n      // opacity et backgroundSize ne passent que par le biais de la ref, \n      // seulement une fois que l'image est réellement loadée\n      image.current.style.opacity = opacity;\n      image.current.style.backgroundSize = size;\n    }\n  }, [loading, size, opacity]);\n  return _react.default.createElement(\"div\", {\n    className: \"bgContainer\",\n    style: bgContainerStyle,\n    onClick: onClick\n  }, _react.default.createElement(\"div\", {\n    ref: image,\n    className: \"bg\",\n    style: bgStyle\n  }), loading && _react.default.createElement(_spinner.default, null), _react.default.createElement(\"div\", {\n    style: {\n      position: \"relative\"\n    }\n  }, !loading && !error && props.children, error));\n};\n\nBackgroundImage.propTypes = {\n  src: _propTypes.default.string.isRequired,\n  position: _propTypes.default.string,\n  width: _propTypes.default.string,\n  height: _propTypes.default.string,\n  opacity: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),\n  color: _propTypes.default.string,\n  transition: _propTypes.default.string,\n  radius: _propTypes.default.string,\n  size: _propTypes.default.string,\n  onClick: _propTypes.default.func\n};\nBackgroundImage.defaultProps = {\n  src: \"\",\n  position: \"relative\",\n  width: \"300px\",\n  height: \"300px\",\n  opacity: \"1\",\n  color: \"#ccc\",\n  transition: \"1s\",\n  radius: \"0\",\n  size: \"cover\",\n  onClick: function onClick() {}\n};\nvar _default = BackgroundImage;\nexports.default = _default;\n\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}